---
title: "Final Project"
author: "Alec Meyer"
date: '2022-04-18'
output: html_document
---

Split the clarity into two categories
```{r}
diamonds <- read.csv("/Users/alecrmeyer/Downloads/diamonds.csv", header=TRUE)
diamonds$clarity <- as.factor(diamonds$clarity)
table(diamonds$clarity)


library(dplyr)

new.levels<-c('below', 'below', 'below', 'above', 'below', 'below', 'below', 'below', 'above', 'above', 'above')
clarity <- factor(new.levels[diamonds$clarity])
diamonds$clarityBin <- as.factor(clarity)

diamonds$lab = as.factor(diamonds$lab)

diamonds$widthlength = diamonds$meas_width * diamonds$meas_length

diamonds = subset(diamonds,select=c( color, clarityBin, cut, 
                                    depth_percent, table_percent, widthlength, meas_depth, total_sales_price))

```


```{r}
above <- sum(diamonds$clarityBin == "above")

below <- sum(diamonds$clarityBin == "below")

rateAbove <- above / (above+below)
rateBelow <- below / (above+below)

```
Random Forrest
```{r}
library(randomForest)

train = sample(1:nrow(diamonds),nrow(diamonds)/2)
dim(diamonds)

diamonds$color <- as.factor(diamonds$color)

bag = randomForest(diamonds$clarity~.,data=diamonds, subset = train, mtry = 3, importance = TRUE, ntree=500)

rf.prob = predict(bag, newdata = diamonds[-train,]) 

```

```{r}

tab <- table(rf.prob, diamonds[-train,]$clarity)
misclass <- 1-mean(rf.prob == diamonds[-train,]$clarity)

```

normalize total sales price
```{r}
diamonds <- diamonds %>% filter(diamonds$total_sales_price < 10000)
x <- qnorm(1-exp(-1/mean(diamonds$total_sales_price)*diamonds$total_sales_price))

```